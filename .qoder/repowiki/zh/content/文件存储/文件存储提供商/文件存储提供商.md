
# 文件存储提供商

<cite>
**本文档中引用的文件**
- [AbpFileStoringFileSystemModule.cs](file://framework\src\SharpAbp.Abp.FileStoring.FileSystem\SharpAbp\Abp\FileStoring\FileSystem\AbpFileStoringFileSystemModule.cs)
- [FileSystemFileProviderConfiguration.cs](file://framework\src\SharpAbp.Abp.FileStoring.FileSystem\SharpAbp\Abp\FileStoring\FileSystem\FileSystemFileProviderConfiguration.cs)
- [FileSystemFileProviderConfigurationNames.cs](file://framework\src\SharpAbp.Abp.FileStoring.FileSystem\SharpAbp\Abp\FileStoring\FileSystem\FileSystemFileProviderConfigurationNames.cs)
- [AbpFileStoringAliyunModule.cs](file://framework\src\SharpAbp.Abp.FileStoring.Aliyun\SharpAbp\Abp\FileStoring\Aliyun\AbpFileStoringAliyunModule.cs)
- [AliyunFileProviderConfiguration.cs](file://framework\src\SharpAbp.Abp.FileStoring.Aliyun\SharpAbp\Abp\FileStoring\Aliyun\AliyunFileProviderConfiguration.cs)
- [AliyunFileProviderConfigurationNames.cs](file://framework\src\SharpAbp.Abp.FileStoring.Aliyun\SharpAbp\Abp\FileStoring\Aliyun\AliyunFileProviderConfigurationNames.cs)
- [AbpFileStoringMinioModule.cs](file://framework\src\SharpAbp.Abp.FileStoring.Minio\SharpAbp\Abp\FileStoring\Minio\AbpFileStoringMinioModule.cs)
- [MinioFileProviderConfiguration.cs](file://framework\src\SharpAbp.Abp.FileStoring.Minio\SharpAbp\Abp\FileStoring\Minio\MinioFileProviderConfiguration.cs)
- [MinioFileProviderConfigurationNames.cs](file://framework\src\SharpAbp.Abp.FileStoring.Minio\SharpAbp\Abp\FileStoring\Minio\MinioFileProviderConfigurationNames.cs)
- [AbpFileStoringAwsModule.cs](file://framework\src\SharpAbp.Abp.FileStoring.Aws\SharpAbp\Abp\FileStoring\Aws\AbpFileStoringAwsModule.cs)
- [AwsFileProviderConfiguration.cs](file://framework\src\SharpAbp.Abp.FileStoring.Aws\SharpAbp\Abp\FileStoring\Aws\AwsFileProviderConfiguration.cs)
- [AbpFileStoringAzureModule.cs](file://framework\src\SharpAbp.Abp.FileStoring.Azure\SharpAbp\Abp\FileStoring\Azure\AbpFileStoringAzureModule.cs)
- [AzureFileProviderConfiguration.cs](file://framework\src\SharpAbp.Abp.FileStoring.Azure\SharpAbp\Abp\FileStoring\Azure\AzureFileProviderConfiguration.cs)
</cite>

## 目录
1. [简介](#简介)
2. [文件系统存储提供商](#文件系统存储提供商)
3. [阿里云OSS存储提供商](#阿里云oss存储提供商)
4. [MinIO存储提供商](#minio存储提供商)
5. [AWS S3存储提供商](#aws-s3存储提供商)
6. [Azure Blob Storage存储提供商](#azure-blob-storage存储提供商)

## 简介
SharpAbp框架提供了一套统一的文件存储抽象层，支持多种文件存储提供商。该文档详细介绍了`SharpAbp.Abp.FileStoring.FileSystem`、`SharpAbp.Abp.FileStoring.Aliyun`、`SharpAbp.Abp.FileStoring.Minio`等模块的实现，包括各自的`FileProvider`实现类、配置类和配置扩展方法。

## 文件系统存储提供商

`SharpAbp.Abp.FileStoring.FileSystem`模块提供了基于本地文件系统的文件存储功能。该模块通过`FileSystemFileProvider`类实现文件操作，使用`FileSystemFileProviderConfiguration`类进行配置管理。

### 配置类与参数
`FileSystemFileProviderConfiguration`类封装了文件系统存储的所有配置项，主要包含：
- **BasePath**: 存储根路径，如"/data1"
- **AppendContainerNameToBasePath**: 是否在基础路径后附加容器名称，默认为true
- **HttpServer**: 访问服务器URL，用于生成文件访问链接

配置项通过`FileSystemFileProviderConfigurationNames`常量类定义，其中`ProviderName`值为"FileSystem"。

### 模块初始化
`AbpFileStoringFileSystemModule`在预配置阶段向`AbpFileStoringAbstractionsOptions`注册文件提供商配置，设置默认的命名规范化器，并添加必要的配置项。

**Section sources**
- [AbpFileStoringFileSystemModule.cs](file://framework\src\SharpAbp.Abp.FileStoring.FileSystem\SharpAbp\Abp\FileStoring\FileSystem\AbpFileStoringFileSystemModule.cs#L0-L76)
- [FileSystemFileProviderConfiguration.cs](file://framework\src\SharpAbp.Abp.FileStoring.FileSystem\SharpAbp\Abp\FileStoring\FileSystem\FileSystemFileProviderConfiguration.cs#L0-L39)
- [FileSystemFileProviderConfigurationNames.cs](file://framework\src\SharpAbp.Abp.FileStoring.FileSystem\SharpAbp\Abp\FileStoring\FileSystem\FileSystemFileProviderConfigurationNames.cs#L0-L11)

## 阿里云OSS存储提供商

`SharpAbp.Abp.FileStoring.Aliyun`模块提供了对阿里云对象存储服务（OSS）的支持。该模块通过`AliyunFileProvider`类实现与OSS的交互。

### 配置类与参数
`AliyunFileProviderConfiguration`类提供了对OSS配置的强类型访问，主要配置参数包括：
- **AccessKeyId** 和 **AccessKeySecret**: 访问密钥ID和密钥
- **Endpoint**: OSS服务端点，如"https://oss-cn-hangzhou.aliyuncs.com"
- **RegionId**: 区域ID，如"oss-cn-hangzhou"
- **BucketName**: 存储桶名称
- **UseSecurityTokenService**: 是否使用STS临时授权
- **CreateContainerIfNotExists**: 当容器不存在时是否自动创建

### STS临时授权支持
该模块支持通过安全令牌服务（STS）进行临时授权访问，相关配置包括：
- **RoleArn**: 角色ARN标识
- **RoleSessionName**: 会话名称
- **DurationSeconds**: 临时凭证有效期（秒）
- **Policy**: 权限策略
- **TemporaryCredentialsCacheKey**: 临时凭证缓存键

**Section sources**
- [AbpFileStoringAliyunModule.cs](file://framework\src\SharpAbp.Abp.FileStoring.Aliyun\SharpAbp\Abp\FileStoring\Aliyun\AbpFileStoringAliyunModule.cs#L0-L90)
- [AliyunFileProviderConfiguration.cs](file://framework\src\SharpAbp.Abp.FileStoring.Aliyun\SharpAbp\Abp\FileStoring\Aliyun\AliyunFileProviderConfiguration.cs#L0-L113)
- [AliyunFileProviderConfigurationNames.cs](file://framework\src\SharpAbp.Abp.FileStoring.Aliyun\SharpAbp\Abp\FileStoring\Aliyun\AliyunFileProviderConfigurationNames.cs#L0-L21)

## MinIO存储提供商

`SharpAbp.Abp.FileStoring.Minio`模块提供了对MinIO对象存储的支持。MinIO是一个高性能的对象存储，兼容Amazon S3 API。

### 配置类与参数
`MinioFileProviderConfiguration`类封装了MinIO存储的所有配置，主要参数包括：
- **EndPoint**: MinIO服务端点，如"192.168.0.100:9005"
- **AccessKey** 和 **SecretKey**: 访问密钥和密钥
- **BucketName**: 存储桶名称
- **WithSSL**: 是否使用SSL加密连接
- **CreateBucketIfNotExists**: 当存储桶不存在时是否自动创建

### 配置示例
```json
{
  "FileStoring": {
    "Providers": {
      "Minio": {
        "Minio.EndPoint": "192.168.0.100:9005",
        "Minio.AccessKey": "minioadmin",
        "Minio.SecretKey": "minioadmin",
        "Minio.BucketName": "mybucket",
        "Minio.WithSSL": false
      }
    }
  }
}
```

**Section sources**
- [AbpFileStoringMinioModule.cs](file://framework\src\SharpAbp.Abp.FileStoring.Minio\SharpAbp\Abp\FileStoring\Minio\AbpFileStoringMinioModule.cs#L0-L80)
- [MinioFileProviderConfiguration.cs](file://framework\src\SharpAbp.Abp.FileStoring.Minio\SharpAbp\Abp\FileStoring\Minio\MinioFileProviderConfiguration.cs#L0-L65)
- [MinioFileProviderConfigurationNames.cs](file://framework\src\SharpAbp.Abp.FileStoring.Minio\SharpAbp\Abp\FileStoring\Minio\MinioFile